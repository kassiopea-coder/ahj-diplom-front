{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj-diplom-front/./src/js/emoji.js","webpack://ahj-diplom-front/./src/img/background.jpg","webpack://ahj-diplom-front/./src/img/check-ok.png","webpack://ahj-diplom-front/./src/img/clip.png","webpack://ahj-diplom-front/./src/img/cross.png","webpack://ahj-diplom-front/./src/img/download.png","webpack://ahj-diplom-front/./src/img/geo.png","webpack://ahj-diplom-front/./src/img/pencil.png","webpack://ahj-diplom-front/./src/img/phone.png","webpack://ahj-diplom-front/./src/img/smail.png","webpack://ahj-diplom-front/./src/img/video.png","webpack://ahj-diplom-front/webpack/bootstrap","webpack://ahj-diplom-front/webpack/runtime/global","webpack://ahj-diplom-front/webpack/runtime/publicPath","webpack://ahj-diplom-front/./src/js/Popup.js","webpack://ahj-diplom-front/./src/js/Clip.js","webpack://ahj-diplom-front/./src/js/AVRec.js","webpack://ahj-diplom-front/./src/js/GeoLocation.js","webpack://ahj-diplom-front/./src/js/ApiConnector.js","webpack://ahj-diplom-front/./src/js/PinMessage.js","webpack://ahj-diplom-front/./src/js/Message.js","webpack://ahj-diplom-front/./src/js/app.js"],"sourcesContent":["const emoji = '😀 😁 😂 😃 😄 🤣 😅 😆 😇 😉 😊 🙂 🙃 😋 😌 😍 🥰 😘 😗 😙 😚 🤪 😜 😝 😛 🤑 😶 😡 😱 😨 😰 😢 😥 👍 👎'.split(' ');\n\nif (document) {\n  const btnEmoji = document.getElementById('emoji-btn'); // Кнопка смайлик.\n  const aside = document.getElementsByTagName('aside')[0]; // Боковая панель\n  const emojiContainer = document.getElementById('emoji-container'); // Контейнер со смайликами\n\n  emoji.forEach((emo) => {\n    const div = document.createElement('div');\n    div.innerHTML = emo;\n    div.classList.add('emoji');\n    div.addEventListener('click', (event) => { // Клик по смайлику\n      const input = document.getElementById('input');\n      if (input) input.value += event.target.innerHTML;\n    });\n    emojiContainer.appendChild(div);\n  });\n\n  // Клик по кнопке смайлик.\n  btnEmoji.addEventListener('click', () => {\n    aside.classList.toggle('hidden');\n  });\n}\n","module.exports = __webpack_public_path__ + \"background.jpg\";","module.exports = __webpack_public_path__ + \"check-ok.png\";","module.exports = __webpack_public_path__ + \"clip.png\";","module.exports = __webpack_public_path__ + \"cross.png\";","module.exports = __webpack_public_path__ + \"download.png\";","module.exports = __webpack_public_path__ + \"geo.png\";","module.exports = __webpack_public_path__ + \"pencil.png\";","module.exports = __webpack_public_path__ + \"phone.png\";","module.exports = __webpack_public_path__ + \"smail.png\";","module.exports = __webpack_public_path__ + \"video.png\";","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","/* eslint-disable prefer-destructuring */\n/* eslint-disable no-use-before-define */\nclass Popup {\n  constructor(container) {\n    this.type = '';\n    this.result = false;\n    this.callback = () => {};\n    this.init();\n    this.container = container;\n  }\n\n  init() {\n    if (typeof document !== 'undefined') {\n      this.elPopup = document.createElement('div');\n      this.elPopup.className = 'popup hidden';\n      this.elPopup.innerHTML = `\n    <p class=\"popup-header\"></p>\n    <p class=\"popup-msg\"></p>\n    <div class=\"popup-buttons\">\n      <div class=\"popup-ok popup-btn\">OK</div>\n    </div>\n    `;\n      document.body.appendChild(this.elPopup);\n\n      this.elPopupHeader = document.querySelector('.popup-header');\n      this.elPopupMsg = document.querySelector('.popup-msg');\n      this.btnOk = document.querySelector('.popup-ok');\n    }\n\n    this.btnOk.addEventListener('click', () => {\n      this.callback();\n      this.closePopup();\n      this.callback = () => {};\n    });\n  }\n\n  showPopup(type, header, msg, callback = () => {}) {\n    this.type = type;\n    this.elPopup.classList.remove('hidden');\n    this.elPopupHeader.innerText = header;\n    this.elPopupMsg.innerText = msg;\n    this.callback = callback;\n    if (this.type === 'input') {\n      /* this.elPopupInput.classList.remove('hidden');\n      this.btnCancel.classList.remove('hidden');\n      this.elPopupMsgInput.classList.remove('hidden'); */\n    }\n    this.container.classList.add('blocked');\n    // document.getElementById('controll').classList.add('hidden');\n  }\n\n  closePopup() {\n    this.elPopup.classList.add('hidden');\n    this.elPopupHeader.innerText = null;\n    this.elPopupMsg.innerText = null;\n    this.container.classList.remove('blocked');\n  }\n}\n\nconst container = document.querySelector('.container');\n\nconst popup = new Popup(container);\nexport default popup;\n","/* eslint-disable max-len */\nimport popup from './Popup';\n\nexport default class Clip {\n  constructor(dropArea, callback) {\n    this.maxSize = 734003200;\n    this.dropArea = dropArea;\n    this.inputFile = document.createElement('input');\n    this.init();\n    this.file = null;\n    this.base64 = null;\n    this.createMsg = callback;\n  }\n\n  init() {\n    this.inputFile.type = 'file';\n    this.inputFile.accept = 'audio/*, video/*, image/*';\n    // Выбор файла через диалоговое окно\n    this.inputFile.addEventListener('change', async (event) => {\n      this.file = event.currentTarget.files.item(0);\n      this.validFile();\n    });\n    // Drag&Drop\n    this.dropArea.addEventListener('dragover', (event) => event.preventDefault());\n    this.dropArea.addEventListener('drop', async (event) => {\n      event.preventDefault();\n      if (event.dataTransfer.files.length === 1) {\n        this.file = event.dataTransfer.files.item(0);\n        this.validFile();\n      }\n    });\n  }\n\n  openWindowsChangeFile() {\n    this.file = null;\n    // this.base64 = null;\n    this.inputFile.value = '';\n    this.inputFile.click();\n  }\n\n  // Проверка типа файла\n  get typeFile() {\n    let typeFile;\n    if (this.file.type.indexOf('image') >= 0) typeFile = 'img';\n    else if (this.file.type.indexOf('audio') >= 0) typeFile = 'audio';\n    else if (this.file.type.indexOf('video') >= 0) typeFile = 'video';\n    return typeFile;\n  }\n\n  async validFile() {\n    if ((this.typeFile) && (this.file.size < this.maxSize)) { // Проверка на соответсвие типа файла и размера\n      this.createMsg(this.file, this.typeFile);\n      return;\n    }\n    this.file = null;\n    const title = 'Что-то пошло не так';\n    const msgErr = 'Резрешается загружать файлы формата аудио видео и картинки \\n Максимальный объем загружаемого файла 700 MB (734003200 Byte)';\n    popup.showPopup('err', title, msgErr);\n  }\n\n  // Для записи Аудио/Видео сообщений и загрузки файлов.\n  static readFileToBase64(file) {\n    return new Promise((resolve) => {\n      if (!file) resolve(null);\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = (readerEvent) => {\n        resolve(readerEvent.target.result);\n      };\n    });\n  }\n}\n","/* eslint-disable no-async-promise-executor */\n/* eslint-disable no-return-assign */\n/* eslint-disable no-param-reassign */\n/* eslint-disable prefer-destructuring */\n/* eslint-disable no-unused-expressions */\n/* eslint-disable class-methods-use-this */\n\nimport Clip from './Clip';\n\nconst recordAbort = () => {\n  const startRec = document.getElementById('buttons-start-rec'); // Блок с кнопками записи аудио/видео\n  const stoptRec = document.getElementById('buttons-stop-rec'); // Блок с кнопками остановки записи аудио/видео\n  startRec.classList.remove('hidden');\n  stoptRec.classList.add('hidden');\n};\n\nexport default class AVRec {\n  constructor(popup, timerSpan) {\n    this.popup = popup;\n    this.chunks = [];\n    this.recorder = null;\n    this.record = null;\n    this.recordType = undefined;\n    this.recordFormat = undefined;\n    this.duration = 0;\n    this.durationString = null;\n    this.timer = null;\n    this.recStatus = false;\n    this.time = timerSpan;\n    this.callbackOK = undefined;\n  }\n\n  clear() {\n    this.chunks = [];\n    this.recorder = null;\n    this.record = null;\n    this.recordType = undefined;\n    this.recordFormat = undefined;\n    this.duration = 0;\n    this.durationString = null;\n    this.time.textContent = '';\n    this.recStatus = false;\n    this.callbackOK = undefined;\n  }\n\n  async startRecord(type) {\n    try {\n      if (!navigator.mediaDevices) {\n        const title = 'Что-то пошло не так';\n        const msg = 'Ваш браузер или устройство не поддерживает запись звука/видео';\n        this.popup.showPopup('err', title, msg, recordAbort);\n      }\n      if (!window.MediaRecorder) {\n        const title = 'Что-то пошло не так';\n        const msg = 'Разрешите запись звука/видео в браузере';\n        this.popup.showPopup('err', title, msg, recordAbort);\n      }\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: true,\n        video: (type === 'video'),\n      });\n      if ((type === 'video') && (document)) {\n        const miniVideo = document.createElement('video');\n        miniVideo.controls = true;\n        miniVideo.muted = 'muted';\n        miniVideo.className = 'mini-video';\n        document.body.appendChild(miniVideo);\n        miniVideo.srcObject = stream;\n        miniVideo.play();\n      }\n      this.recorder = new MediaRecorder(stream);\n      this.recorder.addEventListener('start', () => {\n        this.timer = setInterval(() => {\n          this.duration += 1;\n          let min = Math.trunc(this.duration / 60);\n          let sec = this.duration - 60 * min;\n          if (min < 10) min = `0${min}`;\n          if (sec < 10) sec = `0${sec}`;\n          this.time.textContent = `${min}:${sec}`;\n        }, 1000);\n        this.recStatus = true;\n      });\n      this.recorder.addEventListener('dataavailable', (evt) => {\n        this.chunks.push(evt.data);\n      });\n      this.recorder.addEventListener('stop', async () => {\n        const blob = new Blob(this.chunks, {\n          type: `${this.recordType}/${this.recordFormat}`,\n        });\n        this.record = await Clip.readFileToBase64(blob); // результат в формате base64\n        stream.getTracks().forEach((track) => track.stop());\n        this.chunks = [];\n        if (typeof document !== 'undefined') {\n          const minivideo = document.getElementsByClassName('mini-video')[0];\n          if (minivideo) minivideo.remove();\n        }\n        clearInterval(this.timer);\n        this.duration = 0;\n        this.durationString = null;\n        this.recStatus = false;\n        this.callbackOK();\n      });\n      this.recorder.start();\n    } catch (error) {\n      const title = 'Что-то пошло не так';\n      const msgErr = 'Разрешите запись звука/видео в браузере';\n      this.popup.showPopup('err', title, msgErr, recordAbort);\n      this.clear();\n    }\n  }\n\n  async startRecordAudio() {\n    if (this.recorder) return;\n    this.recordType = 'audio';\n    this.recordFormat = 'wav';\n    await this.startRecord('audio');\n  }\n\n  async startRecordVideo() {\n    if (this.recorder) return;\n    this.recordType = 'video';\n    this.recordFormat = 'mp4';\n    await this.startRecord('video');\n  }\n\n  async recordOk(callback = () => {}) {\n    this.callbackOK = callback;\n    this.recorder.stop();\n    this.recorder = null;\n  }\n\n  recordCancel() {\n    this.recorder.stop();\n    this.clear();\n  }\n}\n","/* eslint-disable no-unused-vars */\n\nexport default class GeoLocation {\n  constructor(popup) {\n    this.popup = popup;\n    // this.status = '';\n    // this.err = '';\n    this.coords = undefined;\n    this.corrdsText = null;\n    this.address = null;\n  }\n\n  getGeo() {\n    return new Promise((resolve, reject) => {\n      if (!navigator.geolocation) {\n        // this.err = 'Геолокация не поддерживается в Вашем браузере :(';\n        // this.status = false;\n        // reject();\n        this.address = 'Не определено';\n        resolve();\n      } else {\n        navigator.geolocation.getCurrentPosition(async (position) => {\n          this.coords = position.coords;\n          this.coordsText = `[${this.coords.latitude}, ${this.coords.longitude}]`;\n          await this.getPlace();\n          this.status = true;\n          resolve();\n        }, () => {\n          // this.err = 'Невозможно получить ваше местоположение :(';\n          // this.status = false;\n          // reject();\n          this.address = 'Не определено';\n          resolve();\n        });\n      }\n    });\n  }\n\n  async getPlace() {\n    const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${this.coords.latitude}&lon=${this.coords.longitude}&zoom=18&addressdetails=1`);\n    const { address } = await response.json();\n    const { country, city } = address;\n    if ((country) && (city)) {\n      this.address = `${country}, ${city}`;\n    } else {\n      this.address = `Нет данных <br> [${this.coords.latitude.toFixed(5)}, ${this.coords.longitude.toFixed(5)}]`;\n    }\n  }\n}\n","/* eslint-disable class-methods-use-this */\n/* eslint-disable import/no-cycle */\n/* eslint-disable max-len */\n/* eslint-disable no-restricted-syntax */\n/* eslint-disable guard-for-in */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-useless-return */\n\nimport Message from './Message';\n\n/* eslint-disable no-useless-escape */\nclass ApiConnector {\n  constructor(url) {\n    this.url = url;\n    // this.contentTypeHeader = { 'Content-Type': 'application/json' };\n    this.contentTypeHeader = { 'Content-Type': 'application/x-www-form-urlencoded' };\n  }\n\n  async getMessages(msgListDiv, id = null) { // Загрузка сообщений с сервера\n    // Запоминаем размер скрола, чтобы после подрузки новой порции сообщений восстановить его позицию\n    const beforeScrolHeight = msgListDiv.scrollHeight;\n    let URL = this.url;\n    if (id) {\n      URL += `?id=${id}`; // Передаем id первого сообщения в списке.\n    }\n    const response = await fetch(URL);\n    const messagesList = Array.from(await response.json());\n    messagesList.forEach((msg) => {\n      const message = new Message(msg.type, msg.msg, msg.typeFile, msg.extFile);\n      for (const prop in msg) {\n        message[prop] = msg[prop];\n      }\n      message.timeStamp = new Date(message.timeStamp);\n      msgListDiv.prepend(message.html);\n    });\n    // Восстанавливаем скорл или прокручиваем вниз (если загружается первая порция сообщений)\n    msgListDiv.scrollTop = (id) ? msgListDiv.scrollHeight - beforeScrolHeight : msgListDiv.scrollHeight;\n  }\n\n  async getPinMsg(pinMsg) {\n    // const response = await fetch(`${this.url} ? event=getPinMsg`);\n    const response = await fetch(this.url);\n    const msg = await response.json();\n    if (msg) {\n      const message = new Message(msg.type, msg.msg, msg.typeFile);\n      for (const prop in msg) message[prop] = msg[prop];\n      message.timeStamp = new Date(message.timeStamp);\n      pinMsg.pinned(message, false);\n    }\n  }\n\n  async getFile(fileURL) {\n    const loader = document.getElementsByClassName('cssload-loading')[0]; // Анимация загрузки\n    const container = document.getElementsByClassName('container')[0]; // Контейнер.\n    loader.classList.remove('hidden');\n    container.classList.add('blocked');\n    const response = await fetch(fileURL);\n    const BlobImage = await response.blob();\n    const urlImage = URL.createObjectURL(BlobImage);\n    const link = document.createElement('a');\n    link.href = urlImage;\n    link.download = 'YourFile';\n    link.click();\n    link.remove();\n    loader.classList.add('hidden');\n    container.classList.remove('blocked');\n  }\n\n  async pushMessage(msg) { // Загрузка сообщения на сервер\n    const obj = {\n      msg: msg.msg,\n      type: msg.type,\n      typeFile: msg.typeFile,\n      geolocation: msg.geolocation,\n      timeStamp: +msg.timeStamp,\n    };\n    const formData = new FormData();\n    formData.append('msg', JSON.stringify(obj));\n    if (msg.typeFile) formData.append('file', msg.msg);\n    const response = await fetch(this.url, {\n      method: 'POST',\n      body: formData,\n    });\n    const responseObj = await response.json();\n    msg.id = await responseObj.id;\n    if (responseObj.msg) {\n      msg.msg = responseObj.msg;\n    }\n  }\n\n  async pinnedMessage(id) {\n    const formData = new FormData();\n    formData.append('id', id);\n    const response = await fetch(this.url, {\n      method: 'PATCH',\n      body: formData,\n    });\n    const result = await response.json();\n    return (result === 'OK');\n  }\n\n  async unPinnedMessage() {\n    const response = await fetch(this.url, {\n      method: 'PATCH',\n    });\n    const result = await response.json();\n    return (result === 'OK');\n  }\n\n  async deleteMessage(id) { // Удаление сообщения\n    const URL = `${this.url}?id=${id}`;\n    const response = await fetch(URL, {\n      method: 'DELETE',\n    });\n    const result = await response.json();\n    return (result === 'OK');\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  downloadBase64File(contentBase64, fileName) {\n    const linkSource = contentBase64;\n    const downloadLink = document.createElement('a');\n    document.body.appendChild(downloadLink);\n\n    downloadLink.href = linkSource;\n    downloadLink.target = '_self';\n    downloadLink.download = fileName;\n    downloadLink.click();\n  }\n}\n\n const url = 'https://ahj-diplom-1.herokuapp.com/';\n// const url = '/api/';\n//const url = 'http://localhost:7071';\nconst api = new ApiConnector(url);\nexport default api;\n","/* eslint-disable import/no-cycle */\nimport api from './ApiConnector';\n\nclass PinMessage {\n  constructor(pinArea, messagesList) {\n    this.id = undefined;\n    this.html = undefined;\n    this.pinArea = pinArea; // Зона где закрепляется сообщение.\n    this.messagesList = messagesList; // Список выведенных сообщений.\n  }\n\n  pinned(msg, sendServer = true) { // Закрепить сообщение\n    if (this.id) {\n      return false;\n    }\n    this.id = msg.id;\n    this.html = (msg.html).cloneNode(true);\n    this.html.classList.add('pin');\n    this.html.classList.remove('hidden');\n    this.html.getElementsByClassName('dell-btn')[0].remove();\n    const pinBtn = this.html.getElementsByClassName('pin-btn')[0];\n    pinBtn.classList.remove('hidden');\n    pinBtn.onclick = this.unPinned.bind(this);\n    if (sendServer) { // Отправляем данные на сервер\n      api.pinnedMessage(this.id);\n    }\n    this.pinArea.append(this.html);\n    return true;\n  }\n\n  unPinned() { // Открепить сообщение\n    api.unPinnedMessage(); // Удаляем данные на сервере\n    const serchMsg = this.messagesList.querySelector(`[data-id=\"${this.id}\"]`);\n    if (serchMsg) {\n      serchMsg.classList.remove('hidden');\n    }\n\n    this.id = undefined;\n    this.html = undefined;\n    this.pinArea.innerHTML = '';\n  }\n}\n\nconst pinArea = document.getElementById('messages-pin'); // Зона где закрепляется сообщение.\nconst messagesList = document.getElementById('messages-list'); // Список выведенных сообщений.\n\nconst pinMsg = new PinMessage(pinArea, messagesList);\n\nexport default pinMsg;\n","/* eslint-disable import/no-cycle */\n/* eslint-disable max-len */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-useless-return */\n/* eslint-disable no-useless-escape */\nimport Geolocation from './GeoLocation';\nimport api from './ApiConnector';\nimport pinMsg from './PinMessage';\nimport popup from './Popup';\n\n// const messagesPin = document.getElementById('messages-pin');\n\nexport default class Message {\n  constructor(type, msg, typeFile) {\n    this.id = undefined;\n    this.type = type;\n    this.typeFile = typeFile; // Тип файла. Используется только в том случае если this.type === 'file';\n    this.geolocation = undefined;\n    this.timeStamp = new Date();\n    this.msg = msg; // аудио/видео сообщения хранятся ввиде строки формата base64\n    /* Создаем html элементы (теги) в которых будет хранится контент:\n      <p> - текст\n      <audio> - аудио сообщение\n      <video> - видео сообщение\n      <div> - файл.\n    */\n    if (this.type === 'text') { // текст\n      this.msgTag = document.createElement('p');\n      this.msgTag.innerHTML = Message.createLink(this.msg); // находим в тексте ссылки и делаем их кликабельными\n    }\n    if ((this.type === 'audio') || (this.type === 'video')) { // аудио/видео\n      this.msgTag = document.createElement(this.type);\n      this.msgTag.src = this.msg;\n      this.msgTag.controls = true;\n    }\n    if (this.type === 'file') { // Файл.\n      this.msgTag = document.createElement(this.typeFile);\n      if (this.typeFile === 'img') this.msgTag.classList.add('msg-img');\n      if ((this.typeFile === 'audio') || (this.typeFile === 'video')) this.msgTag.controls = true;\n    }\n  }\n\n  get time() {\n    let day = this.timeStamp.getDate();\n    let month = this.timeStamp.getMonth();\n    let year = this.timeStamp.getFullYear();\n    let hours = this.timeStamp.getHours();\n    let minutes = this.timeStamp.getMinutes();\n    if (day < 10) day = `0${day}`;\n    if (month < 10) month = `0${month}`;\n    if (year < 10) year = `0${year}`;\n    if (hours < 10) hours = `0${hours}`;\n    if (minutes < 10) minutes = `0${minutes}`;\n    return `${day}-${month}-${year}  ${hours}:${minutes}`;\n  }\n\n  get html() {\n    // Если сообщение - файл то прописываем src путь т.к. он становится известен не при создании сообщения, а только после присвоения сообщению id на сервере.\n    if (this.typeFile) this.msgTag.src = this.msg;\n    // Если сообщение - файл то верстаем кнопку download\n    const download = (this.typeFile) ? `<a class=\"download-btn\" href=\"${this.msg}\"></a>` : '';\n    // Верстаем сообщение.\n    const divMessage = document.createElement('div');\n    divMessage.classList.add('message');\n    divMessage.dataset.id = this.id;\n    divMessage.innerHTML = `<div class=\"msg-header\">\n                              <div class=\"dell-btn hidden\">&#10060</div>\n                              <div class=\"pin-btn hidden\">&#x1F4CC</div>\n                              <time>${this.time}</time>\n                            </div>\n                            <div class=\"msg\"></div>\n                            <div class=\"msg-footer\">\n                              <div class=\"geo__block\">\n                                <img class=\"img-geo\" src=\"geo.png\">\n                                <span class= \"msg__geo\">${this.geolocation}</span>\n                              </div>\n                              ${download}\n                            </div>`;\n    const divMsg = divMessage.querySelector('.msg'); // Контент\n    divMsg.append(this.msgTag.cloneNode(true));\n    const dellBtn = divMessage.getElementsByClassName('dell-btn')[0]; // Кнопка \"Удалить сообщение\"\n    const pinBtn = divMessage.getElementsByClassName('pin-btn')[0]; // Кнопка \"закрепить сообщение\"\n    const downloadBtn = divMessage.getElementsByClassName('download-btn')[0];\n\n    if (downloadBtn) { // Программируем кнопку download\n      downloadBtn.addEventListener('click', async (evt) => {\n        evt.preventDefault();\n        await api.getFile(this.msg);\n      });\n    }\n    divMessage.addEventListener('mouseover', () => { // Показываем кнопки \"Удалить сообщение\" и \"Pin\"\n      dellBtn.classList.remove('hidden');\n      pinBtn.classList.remove('hidden');\n    });\n    divMessage.addEventListener('mouseout', () => { // Скрываем кнопки \"Удалить сообщения\" и \"Pin\"\n      dellBtn.classList.add('hidden');\n      pinBtn.classList.add('hidden');\n    });\n    dellBtn.addEventListener('click', async () => { // Клик по кнопке \"Удалить сообщения\"\n      if (await api.deleteMessage(this.id)) dellBtn.closest('.message').remove();\n    });\n    pinBtn.addEventListener('click', () => { // Клик по кнопке \"Pin\"\n      if (pinMsg.pinned(this)) divMessage.classList.add('hidden');\n    });\n\n    // Проверка запинено данное сообщение или нет. Если да то скрываем его\n    if (this.id === pinMsg.id) divMessage.classList.add('hidden');\n\n    return divMessage;\n  }\n\n  getGeolocation() {\n    return this;\n  }\n\n  static createLink(text) {\n    const links = text.match(/(?:(?:https?|ftp|file):\\/\\/|www\\.|ftp\\.)(?:\\([-A-Z0-9+&@#\\/%=~_|$?!:,.]*\\)|[-A-Z0-9+&@#\\/%=~_|$?!:,.])*(?:\\([-A-Z0-9+&@#\\/%=~_|$?!:,.]*\\)|[A-Z0-9+&@#\\/%=~_|$])/igm);\n    if (links) {\n      links.forEach((find) => {\n        const replace = `<a href=\"${find}\">${find}</a>`;\n        text = text.replace(new RegExp(find, 'g'), replace);\n      });\n    }\n    return text;\n  }\n\n  static async createMessage(type, msg, typeFile) {\n    const geolocation = new Geolocation(popup);\n    await geolocation.getGeo(); // Получаем геоданные.\n    const message = new Message(type, msg, typeFile);\n    message.geolocation = geolocation.address;\n    return message;\n  }\n}\n","/* eslint-disable import/no-cycle */\n/* eslint-disable import/prefer-default-export */\n/* eslint-disable no-param-reassign */\nimport AVRec from './AVRec';\nimport popup from './Popup';\nimport Message from './Message';\nimport Clip from './Clip';\nimport api from './ApiConnector';\nimport pinMsg from './PinMessage';\nimport './emoji';\n\nfunction load(document) {\n  if (!document) { // Ранний выход\n    return;\n  }\n\n  const messagesList = document.getElementById('messages-list'); // список сообщений\n  const input = document.getElementById('input'); // input для ввода сообщения\n  const btnClip = document.getElementById('clip-btn'); // Кнопка для загрузки файлов.\n  const btnRecAudio = document.getElementById('audio-start-btn'); // Кнопка записи аудио сообщения\n  const btnRecVideo = document.getElementById('video-start-btn'); // Кнопка записи аудио сообщения\n  const startRec = document.getElementById('buttons-start-rec'); // Блок с кнопками записи аудио/видео\n  const stoptRec = document.getElementById('buttons-stop-rec'); // Блок с кнопками остановки записи аудио/видео\n  const timer = document.getElementById('timer'); // Таймер (длительность видео/аудио записи)\n  const btnOk = document.getElementById('ok-btn'); // Остановка виде/аудио записи. Сохранение\n  const btnCancel = document.getElementById('cancel-btn'); // Остановка виде/аудио записи. Отмена\n\n  api.getPinMsg(pinMsg); // Загружаем pin-сообщение (если оно есть).\n  api.getMessages(messagesList); // Загружаем последние 10 сообщений\n  const avRec = new AVRec(popup, timer);\n  const clip = new Clip(messagesList, async (file, typeFile) => {\n    const msg = await Message.createMessage('file', file, typeFile);\n    await api.pushMessage(msg);\n    await messagesList.append(msg.html);\n    messagesList.scrollTop = messagesList.scrollHeight; // скрол вниз\n  });\n\n  messagesList.addEventListener('scroll', () => {\n    if (messagesList.scrollTop === 0) {\n      const { id } = messagesList.firstChild.dataset;\n      api.getMessages(messagesList, id); // Загружаем порцию сообщений.\n    }\n  });\n\n  // Запуск запись Аудио\n  btnRecAudio.addEventListener('click', async () => {\n    startRec.classList.add('hidden');\n    await avRec.startRecordAudio();\n    stoptRec.classList.remove('hidden');\n  });\n\n  // Запуск запись Видео\n  btnRecVideo.addEventListener('click', async () => {\n    startRec.classList.add('hidden');\n    await avRec.startRecordVideo();\n    stoptRec.classList.remove('hidden');\n  });\n\n  // Завершение и сохранение видео/аудио сообщения\n  btnOk.addEventListener('click', () => {\n    startRec.classList.remove('hidden');\n    stoptRec.classList.add('hidden');\n    avRec.recordOk(async () => {\n      const msg = await Message.createMessage(avRec.recordType, avRec.record);\n      avRec.clear();\n      await api.pushMessage(msg);\n      messagesList.append(msg.html);\n      messagesList.scrollTop = messagesList.scrollHeight; // скрол вниз\n    });\n  });\n\n  // Отмена записи аудио/видео сообщения\n  btnCancel.addEventListener('click', () => {\n    startRec.classList.remove('hidden');\n    stoptRec.classList.add('hidden');\n    avRec.recordCancel();\n  });\n\n  // Отправув текстового сообщения\n  input.addEventListener('keydown', async (event) => {\n    if (event.code !== 'Enter') {\n      return;\n    }\n    if (!input.value) {\n      return;\n    }\n    const msg = await Message.createMessage('text', event.target.value);\n    await api.pushMessage(msg);\n    messagesList.append(msg.html);\n    messagesList.scrollTop = messagesList.scrollHeight; // скрол вниз\n    event.target.value = null;\n  });\n\n  btnClip.addEventListener('click', () => {\n    clip.openWindowsChangeFile();\n  });\n}\n\nload(document);\n"],"names":["emoji","split","document","btnEmoji","getElementById","aside","getElementsByTagName","emojiContainer","forEach","emo","div","createElement","innerHTML","classList","add","addEventListener","event","input","value","target","appendChild","toggle","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","g","globalThis","this","Function","e","window","scriptUrl","importScripts","location","currentScript","src","scripts","length","Error","replace","p","container","querySelector","popup","constructor","type","result","callback","init","elPopup","className","body","elPopupHeader","elPopupMsg","btnOk","closePopup","showPopup","header","msg","remove","innerText","Clip","dropArea","maxSize","inputFile","file","base64","createMsg","accept","async","currentTarget","files","item","validFile","preventDefault","dataTransfer","openWindowsChangeFile","click","typeFile","indexOf","size","Promise","resolve","reader","FileReader","readAsDataURL","onload","readerEvent","recordAbort","startRec","stoptRec","AVRec","timerSpan","chunks","recorder","record","recordType","recordFormat","duration","durationString","timer","recStatus","time","callbackOK","clear","textContent","navigator","mediaDevices","title","MediaRecorder","stream","getUserMedia","audio","video","miniVideo","controls","muted","srcObject","play","setInterval","min","Math","trunc","sec","evt","push","data","blob","Blob","readFileToBase64","getTracks","track","stop","minivideo","getElementsByClassName","clearInterval","start","error","msgErr","startRecord","recordCancel","GeoLocation","coords","corrdsText","address","getGeo","reject","geolocation","getCurrentPosition","position","coordsText","latitude","longitude","getPlace","status","response","fetch","json","country","city","toFixed","api","url","contentTypeHeader","msgListDiv","id","beforeScrolHeight","scrollHeight","URL","Array","from","message","Message","extFile","prop","timeStamp","Date","prepend","html","scrollTop","pinMsg","pinned","fileURL","loader","BlobImage","urlImage","createObjectURL","link","href","download","obj","formData","FormData","append","JSON","stringify","method","responseObj","downloadBase64File","contentBase64","fileName","linkSource","downloadLink","pinArea","messagesList","sendServer","cloneNode","pinBtn","onclick","unPinned","bind","serchMsg","msgTag","createLink","day","getDate","month","getMonth","year","getFullYear","hours","getHours","minutes","getMinutes","divMessage","dataset","dellBtn","downloadBtn","closest","getGeolocation","text","links","match","find","RegExp","Geolocation","btnClip","btnRecAudio","btnRecVideo","btnCancel","avRec","clip","createMessage","firstChild","startRecordAudio","startRecordVideo","recordOk","code","load"],"sourceRoot":""}